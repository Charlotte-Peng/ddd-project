# ddd-project

这是个 ddd-project的**学习项目**，使用的技术栈如下

> 服务体系
>
> > - SpringBoot 2.6.3
> > - SpringAlibabaCloud 2021.0.1.0 全家桶
> > - 日志采用 log4j2 + sl4f 异步
> > - 容器采用undertow
> > - 接口文档采用knife4j
> > - 权限校验采用satoken
> > - ORN框架采用 mybatis-plus(数据兜底) 、 JPA(仅用Redis) 、 Bean Searcher(ORM读)
> > - 连接池采用druid
> > - 工作流采用camunda
> > - Redis主键生成策略工具ulid
> > - sql版本管理工具flyway
> > - 熔断限流 Sentinel(该项目暂未引入，引入很简单无侵入)

整个项目采用缓存写入的思想，也就是用户访问过来，读取的数据不是数据库，而是缓存(后续考虑读取大数据数据库)，数据库只做兜底，用于数据还原等操作，整体的流程大概如下

1. 用户调用写接口 

   > * 将数据放入redis(后续考虑读取大数据数据库) 
   > * 返回给用户结果 
   > * 异步将数据写入数据库，写入对应日志操作(后续可对接Kafka,将消息进行分流，对接大数据平台，再采用Filink进行清洗)

2. 用户调用查询相关接口 

   > 从简单查询Redis获取，复杂查询通过ES或ClickHouse，检索相关接口采用Bean Searcher

3. 用户修改删除操作 

   > 对redis进行操作，通过异步或者订阅将ES数据修改，对于大数据数据库采用删除并增加的方案(非实时)，对于数据库兜底采用打标记

> 运维体系
>
> - mysql可采用主从或其他方案
> - redis需采用集群，且3主3备以上
> - 日志收集目前采用方案为Loki，Prometheus，Grafana(后续如果采用kafka日志收集则可以进行转换)
> - 服务的链路追踪采用SkrWalking可以快速定位问题
> - 服务的平滑升级采用nacos的上下线及权重
> - 服务的打包部署采用Jenkins
> - 打包的镜像存放采用JFrog
> - 服务的稳定状况采用Grafana通知钉钉
> - 服务的启动采用脚本进行部署及启动(目前无法平滑升级，可以采用动态端口，然后手动修改权重，后
> - 自己下线老服务)
> - 小工具(稳定性待确认) 数据库数据监听(类似从库，机制是监听Binog日志)，将数据同步到其他数据库,例如ES
>   服务器采用NGINX进行负载均衡GateWay
